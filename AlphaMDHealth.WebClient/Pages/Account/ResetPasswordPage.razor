@namespace AlphaMDHealth.WebClient
@inherits BasePage
@page "/SetNewPasswordView"
@page "/ChangePasswordView"
@page "/ResetPasswordView"

@if (_isDataFetched)
{
    <BasePage @bind-Error=@Error
              CurrentPage=@this
              PageResources=@_authData.Resources
              RegisterComp=@RegisterControl>
        <ChildContent>
            @if (_isTwoFactorEnabled && _authData.AuthenticationData.PageType == Utility.Pages.ResetPasswordPage)
            {
                <OtpComponent @bind-Value=@_authData.AuthenticationData.Otp
                              PageData=@_authData
                              OnResendClicked=@OnResendLabelClickAsync />
            }
            else if (_authData.AuthenticationData.PageType == Utility.Pages.ChangePasswordPage)
            {
                <AmhEntryControl @bind-Value=@_authData.AuthenticationData.OldPassword
                                 Icon=@ImageConstants.I_PASSWORD_LOCK_ICON
                                 ResourceKey=@ResourceConstants.R_PASSWORD_KEY />
            }

            <AmhEntryControl @bind-Value=@_authData.AuthenticationData.AccountPassword
                             Icon=@ImageConstants.I_PASSWORD_LOCK_ICON
                             ResourceKey=@ResourceConstants.R_NEW_PASSWORD_KEY
                             RegexExpression=@LibSettings.GetSettingValueByKey(_authData.Settings, SettingsConstants.S_PASSWORD_REGEX_KEY) />

            <AmhEntryControl @bind-Value=@_confirmPassword
                             Icon=@ImageConstants.I_PASSWORD_LOCK_ICON
                             ResourceKey=@ResourceConstants.R_CONFIRM_PASSWORD_KEY />
        </ChildContent>
        <PageFooter>
            <AmhButtonControl ResourceKey=@ResourceConstants.R_SET_BUTTON_KEY Class="my-3"
                              OnValueChanged=@OnSendClickAsync />

            @if (_authData.AuthenticationData.PageType == Utility.Pages.ResetPasswordPage)
            {
                <AmhButtonControl ResourceKey=@ResourceConstants.R_FORGOT_PASSWORD_ACTION_KEY
                                  OnValueChanged=@OnForgotPasswordClickAsync Class="mb-2" />
                <AmhHorizontalRuleControl />
                <AmhButtonControl ResourceKey=@ResourceConstants.R_ALREADY_HAVE_LOGIN_ACTION_KEY Class="mt-2 mb-8"
                                  OnValueChanged=@OnAlreadyHaveAccountClickAsync />
            }
        </PageFooter>
    </BasePage>
}